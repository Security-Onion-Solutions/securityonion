{
  "description" : "bro_smtp",
  "processors" : [
    { "json":		{ "field": "message",			"target_field": "message2",		"ignore_failure": true	} },
    { "remove":		{ "field": "path",			"ignore_failure": true						} },
    { "rename": 	{ "field": "message2.uid", 	 	"target_field": "uid",			"ignore_missing": true 	} },
    { "dot_expander": 	{ "field": "id.orig_h", 		"path": "message2", 			"ignore_failure": true 	} },
    { "rename": 	{ "field": "message2.id.orig_h", 	"target_field": "source_ip",		"ignore_missing": true 	} },
    { "dot_expander": 	{ "field": "id.orig_p", 		"path": "message2",			"ignore_failure": true 	} },
    { "rename": 	{ "field": "message2.id.orig_p", 	"target_field": "source_port",		"ignore_missing": true 	} },
    { "dot_expander": 	{ "field": "id.resp_h", 		"path": "message2",			"ignore_failure": true 	} },
    { "rename": 	{ "field": "message2.id.resp_h", 	"target_field": "destination_ip",	"ignore_missing": true 	} },
    { "dot_expander": 	{ "field": "id.resp_p", 		"path": "message2",			"ignore_failure": true 	} },
    { "rename": 	{ "field": "message2.id.resp_p", 	"target_field": "destination_port",	"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.trans_depth", 	"target_field": "trans_depth",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.helo", 		"target_field": "helo",			"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.mailfrom", 	"target_field": "mail_from",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.rcptto", 		"target_field": "recipient_to",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.date", 		"target_field": "mail_date",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.from", 		"target_field": "from",			"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.to", 		"target_field": "to",			"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.cc", 		"target_field": "cc",			"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.reply_to", 	"target_field": "reply_to",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.msg_id", 		"target_field": "message_id",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.in_reply_to", 	"target_field": "in_reply_to",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.subject", 		"target_field": "subject",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.x_originating_ip",	"target_field": "x_originating_ip",	"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.first_received", 	"target_field": "first_received",	"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.second_received",	"target_field": "second_received",	"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.last_reply",	"target_field": "last_reply",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.path", 		"target_field": "path",			"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.user_agent", 	"target_field": "useragent",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.tls", 		"target_field": "tls",			"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.fuids", 		"target_field": "fuids",		"ignore_missing": true 	} },
    { "rename": 	{ "field": "message2.is_webmail",	"target_field": "is_webmail",		"ignore_missing": true 	} },
    { "pipeline":       { "name": "bro_common"                                                                                   } }
  ]
}
